<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Database Cleanup Report - Search Terms</title>
    <link rel="stylesheet" href="css/database-cleanup.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüîß%3C/text%3E%3C/svg%3E"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üìã Database Cleanup Report</h1>
        <p>Individual search terms requiring database corrections</p>
      </div>

      <!-- <div class="summary">
        <h2>Executive Summary</h2>
        <p>
          This report identifies
          <strong id="totalProblems">-</strong> individual search terms in the
          database that are causing search failures. Each term is listed
          separately with specific issues identified and recommended
          corrections. The database administrator should review each entry and
          apply the suggested fixes to improve search functionality.
        </p>
      </div> -->

      <div class="stats">
        <div class="stat-card">
          <div class="stat-number" id="totalTerms">-</div>
          <div>Total Problem Terms</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalErrors">-</div>
          <div>Total Errors</div>
          <div class="stat-subtitle">
            Formatting, Incomplete, Typos, Spacing, Synonyms
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="missingPortfolio">-</div>
          <div>Missing Portfolio</div>
          <div class="stat-subtitle">Missing Assortment, BBD</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="seasonalAvailability">-</div>
          <div>Seasonality & Availability</div>
          <div class="stat-subtitle">Seasonal, Not Available</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalImpact">-</div>
          <div>Total Failed Searches</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="completedCount">-</div>
          <div>Completed Items</div>
        </div>
        <div class="stat-card progress-card">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">0% Complete</div>
        </div>
      </div>

      <div class="filters">
        <div class="filter-row">
          <div class="filter-group">
            <label for="searchFilter">Search Terms</label>
            <input
              type="text"
              id="searchFilter"
              placeholder="Search for specific terms..."
            />
          </div>
          <div class="filter-group">
            <label for="impactFilter">Impact Level</label>
            <select id="impactFilter">
              <option value="">All Impact Levels</option>
              <option value="critical">Critical (20+)</option>
              <option value="high">High (10-19)</option>
              <option value="medium">Medium (5-9)</option>
              <option value="low">Low (1-4)</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="sortFilter">Sort By</label>
            <select id="sortFilter">
              <option value="impact">Impact (High to Low)</option>
              <option value="alphabetical">Alphabetical</option>
              <option value="category">Issue Type</option>
            </select>
          </div>
        </div>

        <div>
          <label
            style="
              font-weight: 600;
              color: #555;
              margin-bottom: 10px;
              display: block;
            "
            >Filter by Issue Type</label
          >
          <div class="category-filters">
            <button class="category-btn active" data-category="">
              All Issues
            </button>
            <button class="category-btn" data-category="formatting">
              Formatting
            </button>
            <button class="category-btn" data-category="incomplete">
              Incomplete
            </button>
            <button class="category-btn" data-category="typo">Typos</button>
            <button class="category-btn" data-category="spacing">
              Spacing
            </button>
            <button class="category-btn" data-category="synonym">
              Synonyms
            </button>
            <button class="category-btn" data-category="missing-assortment">
              Missing Assortment
            </button>
            <button class="category-btn" data-category="bbd">BBD</button>
            <button class="category-btn" data-category="seasonal">
              Seasonal
            </button>
            <button class="category-btn" data-category="not-available">
              Not Available
            </button>
            <button class="category-btn" data-category="unknown">
              Unknown
            </button>
          </div>
        </div>
      </div>

      <div class="results-container">
        <div class="results-header">
          <div class="results-count" id="resultsCount">Loading...</div>
          <div class="header-actions">
            <div class="bulk-actions" id="bulkActions" style="display: none">
              <span class="bulk-count" id="bulkCount">0 selected</span>
              <button class="bulk-btn" onclick="bulkMarkComplete()">
                Mark Complete
              </button>
              <button class="bulk-btn" onclick="showBulkCategoryMenu()">
                Change Category
              </button>
              <button class="bulk-btn" onclick="showBulkTermEditor()">
                Edit Terms
              </button>
              <button class="bulk-btn secondary" onclick="clearSelection()">
                Clear
              </button>
            </div>
            <div class="firebase-status" id="firebaseStatus">
              <span class="status-indicator" id="statusIndicator">‚óè</span>
              <span id="statusText">Checking Firebase...</span>
            </div>
            <button class="export-btn" onclick="exportCleanupReport()">
              Export Cleanup Report
            </button>
            <button class="export-btn" onclick="exportSQLScript()">
              Export SQL Script
            </button>
          </div>
        </div>
        <div class="results-table-container">
          <table class="results-table">
            <thead>
              <tr>
                <th>
                  <input
                    type="checkbox"
                    id="selectAll"
                    class="select-all-checkbox"
                  />
                  <label for="selectAll" class="select-all-label">Select</label>
                </th>
                <th>Fixed</th>
                <th>#</th>
                <th>Current Term (Database)</th>
                <th>Failed Searches</th>
                <th>Issue Type</th>
                <th>Specific Problems</th>
                <th>Recommended Fix</th>
                <th>Proposed Corrected Term</th>
                <th>Priority</th>
              </tr>
            </thead>
            <tbody id="resultsBody">
              <tr>
                <td colspan="10" class="loading">
                  Loading database cleanup report...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import {
        getFirestore,
        doc,
        setDoc,
        getDoc,
        onSnapshot,
        collection,
        updateDoc,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      // Your Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCVbGeeno9ad0flwgZFzvPVFR9FfeTKkmU",
        authDomain: "data-cleanup-55d94.firebaseapp.com",
        projectId: "data-cleanup-55d94",
        storageBucket: "data-cleanup-55d94.firebasestorage.app",
        messagingSenderId: "252391279499",
        appId: "1:252391279499:web:e6cf57222358464311fd8e",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Make Firebase available globally
      window.firebaseDB = db;
      window.firebaseDoc = doc;
      window.firebaseSetDoc = setDoc;
      window.firebaseGetDoc = getDoc;
      window.firebaseOnSnapshot = onSnapshot;
      window.firebaseCollection = collection;
      window.firebaseUpdateDoc = updateDoc;
    </script>
    <script src="js/database-cleanup.js"></script>
  </body>
</html>
